<IfModule mod_rewrite.c>

    <IfModule mod_negotiation.c>
        Options -MultiViews
    </IfModule>
    
    RewriteEngine On

    RewriteCond %{REQUEST_FILENAME} -d [OR]
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule ^ ^$1 [N]

    RewriteCond %{REQUEST_URI} (\.\w+$) [NC]
    RewriteRule ^(.*)$ public/$1 

    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^ server.php
</IfModule>


<IfModule mod_headers.c>

  RequestHeader unset X-Forwarded-For
  RequestHeader unset X-Client-IP

  # For DICT compliance -- VAPT finding solution
  Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
  
  # helps prevent clickjacking attacks by restricting the ability to embed your website in an iframe
  # Header always set X-Frame-Options "SAMEORIGIN"

  # prevents browsers from interpreting files as a different MIME type
  Header always set X-Content-Type-Options "nosniff"

  # Sends full referrer information for same-origin requests and only the origin for cross-origin requests
  Header always set Referrer-Policy "strict-origin-when-cross-origin"

  # Limits what APIs and features the browser can use
  Header always set Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=(), usb=()"

  #Header set Cache-Control "no-store"
  Header always set Cache-Control "no-store, no-cache, must-revalidate"

  
</IfModule>


<IfModule mod_expires.c>
  # Turn on the ability to set expiry-based caching
  ExpiresActive On

  # Cache images and media for 1 month
  ExpiresByType image/jpeg    "access plus 1 month"
  ExpiresByType image/png     "access plus 1 month"
  ExpiresByType image/gif     "access plus 1 month"
  ExpiresByType image/webp    "access plus 1 month"
  ExpiresByType image/svg+xml "access plus 1 month"
  ExpiresByType image/x-icon  "access plus 1 month"
  ExpiresByType video/mp4     "access plus 1 month"

  # Cache CSS and JavaScript for 1 week
  ExpiresByType text/css      "access plus 1 week"
  ExpiresByType text/javascript "access plus 1 week"
  ExpiresByType application/javascript "access plus 1 week"

</IfModule>

# php -- BEGIN cPanel-generated handler, do not edit
# Set the “ea-php74” package as the default “PHP” programming language.
<IfModule mime_module>
  AddHandler application/x-httpd-ea-php74___lsphp .php .php7 .phtml
</IfModule>
# php -- END cPanel-generated handler, do not edit
